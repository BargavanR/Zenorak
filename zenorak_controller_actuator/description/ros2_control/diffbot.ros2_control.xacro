<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:macro name="diffbot_ros2_control" params="name prefix link1_name='link_1_joint' link2_name='link_2_joint' link3_name='link_3_joint'">

    <ros2_control name="${name}" type="system">
      <hardware>
        <plugin>zenorak_controller_actuator/Zenorak_Hardware_Actuator</plugin>
        <!-- Wheel/motor parameters removed - only actuator params kept -->
        <param name="device">/dev/ttyACM0</param>
        <param name="baud_rate">115200</param>
        <param name="timeout_ms">1000</param>
        <!-- enc_counts_per_rev removed -->
        <param name="pid_p">20</param>
        <param name="pid_d">12</param>
        <param name="pid_i">0</param>
        <param name="pid_o">50</param>
        <!-- Manipulator link names and encoder/ADC mapping values -->
        <!-- Use macro parameters so these names are available when the macro is instantiated -->
        <param name="link1_name">${link1_name}</param>
        <param name="link2_name">${link2_name}</param>
        <param name="link3_name">${link3_name}</param>
        <!-- counts per revolution or ADC full-scale mapping used by Actuator.setup -->
        <param name="link1_enc_val">1023</param>
        <param name="link2_enc_val">1023</param>
        <param name="link3_enc_val">1023</param>
      </hardware>
      <!-- Wheel joints removed from ros2_control description; only manipulator joints exported -->

      <!-- Manipulator joints: these should match the joint names in your robot URDF/xacro -->
      <joint name="${prefix}${link1_name}">
        <command_interface name="position"/>
        <state_interface name="position"/>
      </joint>

      <joint name="${prefix}${link2_name}">
        <command_interface name="position"/>
        <state_interface name="position"/>
      </joint>

      <joint name="${prefix}${link3_name}">
        <command_interface name="position"/>
        <state_interface name="position"/>
      </joint>
    </ros2_control>


  </xacro:macro>

</robot>
